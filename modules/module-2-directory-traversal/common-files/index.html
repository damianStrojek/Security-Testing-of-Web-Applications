<!-- 

  Copyright (C) 2023 Damian Strojek, Patryk Sikora

  Security Testing Environment for Web Applications
  Realised as part of engineering degree for Gdansk University of Technology

-->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <!-- Materialize - Compiled and minified CSS-->
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/materialize/0.95.3/css/materialize.min.css" />
  <!-- Font Awesome Icon - CSS-->
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" />
  <!-- Material Design Icons -->
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@mdi/font@7.2.96/css/materialdesignicons.min.css" />
  <!-- Custom Styles-->
  <link rel="stylesheet" href="./../../../assets/css/style.css" />
  <link rel="icon" href="./../../../assets/img/directory-traverse.png" />
  <title>Common Files</title>
</head>
<body>
<!-- Navigation Menu-->
<nav class="hide-on-small-only">
  <ul class="side-nav fixed section table-of-contents">
    <li class="logo">
      <a id="logo-container" aria-label="Navigate to the beginning of the page" href="#intro"
      class="brand-logo grey-blue-text">
      <img src="./../../../assets/img/directory-traverse.png" class="img-responsive nav-pic" alt="avatar">
      </a>
    </li>
    <li class="bold">
      <a aria-label="Back to the Theory section" href="./../index.html#vulnerable-websites" class="waves-effect waves-dark teal-text"><i
      class="mdi mdi-arrow-collapse-left small"></i><span>Go Back</span></a>
    </li>
    <li class="bold">
      <a aria-label="Scenario" href="#scenario" class="waves-effect waves-dark teal-text"><i
      class="mdi mdi-account-question small"></i><span>Scenario</span></a>
    </li>
    <li class="bold">
      <a aria-label="php, txt, xml Files" href="#php" class="waves-effect waves-dark teal-text"><i
      class="mdi mdi-map-search-outline small"></i><span>PHP&TXT&XML</span></a>
    </li>
    <li class="bold">
      <a aria-label="Log and Backup Files" href="#log" class="waves-effect waves-dark teal-text"><i
      class="mdi mdi-map-search small"></i><span>LOG&BACKUP</span></a>
    </li>
  </ul>
</nav>

<!-- Main Content-->
<main>

  <!-- First Section: Scenario -->
<section id="scenario" class="section scrollspy">
  <h3 class="page-title white-text teal">Scenario</h3>
  <div class="container flow-text">     
    <p>
      <b>Scenario:</b><br>
      One of the lecturers said that he had made the <i>hackme.pg</i> website publicly available. 
      Your task is to find deep files that were hidden away from the plain sight.
      To properly play the role of an attacker, paste the following row into your own <i>/etc/hosts</i> file 
      (the file with the mapping of host IP addresses to their domain names is located elsewhere in non-Unix based systems):
      <br><b>127.0.0.1&emsp;&emsp;hackme.pg</b>
    </p>
    <p>
      Tools that will be useful when carrying out this task:<br>
      - <a href="https://github.com/danielmiessler/SecLists" target="_blank">SecLists</a><br>
      - <a href="https://github.com/OJ/gobuster" target="_blank">Gobuster</a><br>
      - <a href="https://www.kali.org/tools/dirbuster/" target="_blank">dirbuster</a>
    </p>
    <p>
      If you need any help, you can check the comments left by developers around a given section's source code.
    </p>
  </div>
</section>

<!-- Second section: Php and Txt Files -->
<section id="php" class="section scrollspy">
  <h3 class="page-title white-text teal">PHP, TXT, and XML Files</h3>
  <div class="container flow-text">     
    <p>
      <!-- 
      Hint: 
      Using /seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt and dirbuster is sufficient 
      What you need to add is the extensions of the files. I propose txt, php and xml file extensions :)
      -->
      <b>Your task</b> is to find a suspicious-looking directories and files inside the following document root directory: 
      <br><i>http://hackme.pg/modules/module-2-directory-traversal/common-files/Deep-Internet/</i><br>
      This time you need to search <b>recursively</b> and look at every folder... The "Tree View" in dirbuster should help you.
      <br>From the note left by teacher we know that <b>there should be some files with txt, php and xml extensions...</b>
    </p>
    <div>
      <img src="./../assets/img/common-files-1.png" class="img-modules" alt="find me">
    </div>
    <p style="text-align: left;">
      Flag for <i>/Deep-Internet</i> section:
      <input type="text" id="flag1" class="input-module1">
      <br><br>
      <button id="flag1-button" onclick="checkFlag('flag1')" class="button-module1">pehape?</button>
    </p>
  </div>
</section>

<!-- Third section: Log and Backup Files -->
<section id="log" class="section scrollspy">
  <h3 class="page-title white-text teal">LOG and BACKUP Files</h3>
  <div class="container flow-text">     
    <p>
      <!-- 
      Hint: 
      Using /seclists/Discovery/Web-Content/common.txt and dirbuster is sufficient 
      What you need to add is the extensions of the files. I propose log and bak file extensions :)
      -->
      <b>Your task</b> is to find a suspicious-looking directories and files inside the following document root directory: 
      <br><i>http://hackme.pg/modules/module-2-directory-traversal/common-files/Deep-Database/</i><br>
      This time you need to search <b>recursively</b> and look at every folder... The "Tree View" in dirbuster should help you.
      <br>This time teacher was not able to properly secure his <b>log and backup (.bak) files...</b>
    </p>
    <p style="text-align: left;">
      Flag for <i>.bak</i> file:
      <input type="text" id="flag2" class="input-module1">
      <br><br>
      <button id="flag2-button" onclick="checkFlag('flag2')" class="button-module1">backup!!!</button>
    </p>
    <p style="text-align: left;">
      Flag for <i>.log</i> file:
      <input type="text" id="flag3" class="input-module1">
      <br><br>
      <button id="flag3-button" onclick="checkFlag('flag3')" class="button-module1">Logging everything.</button>
    </p>
  </div>
  <br><br><br><br><br><br><br><br><br><br><br><br><br><br>
</section>

</main>

<!-- jQuery-->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>

<!-- Materialize - Compiled and minified JavaScript-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.95.3/js/materialize.min.js"></script>
<script>
  // Materialize - Initializers
  $(document).ready(function () {
  $(".scrollspy").scrollSpy()
  // Initialize collapse button
  $(".button-collapse").sideNav({
    menuWidth: 190, // Default is 240
    edge: "left", // Choose the horizontal origin
    closeOnClick: true // Closes side-nav on <a> clicks, useful for Angular/Meteor
  })
  });

  const flagConstants = {
    flag1: "0A17645A77488852517031A97099C16AAFB35FAB93C51A273D347D632AF5A3A4",
    flag2: "666212C0CD11DDF471783C27E76C89FBC46B62BEEBF96203AD699D52EEFAEC0C",
    flag3: "AFA58218487B0B70CECCB3666C3E2D21B649BC4C4162FEC5EE153185DB17431F",
  };

  function checkFlag(flagID) {
    const inputField = document.getElementById(flagID);
    const button = document.getElementById(flagID + "-button");

    if (inputField && flagConstants[flagID] === inputField.value) {
      inputField.style.background = "lightgreen";
      button.style.background = "green";
    } else {
      inputField.style.background = "lightcoral";
      button.style.background = "red";
    }
  }
</script>

</body>
</html>