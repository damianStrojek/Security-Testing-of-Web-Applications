<!-- 

  Copyright (C) 2023 Damian Strojek, Patryk Sikora

  Security Testing Environment for Web Applications
  Realised as part of engineering degree for Gdansk University of Technology

-->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <!-- Materialize - Compiled and minified CSS-->
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/materialize/0.95.3/css/materialize.min.css" />
  <!-- Font Awesome Icon - CSS-->
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" />
  <!-- Material Design Icons -->
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@mdi/font@7.2.96/css/materialdesignicons.min.css" />
  <!-- Custom Styles-->
  <link rel="stylesheet" href="./../../assets/css/style.css" />
  <link rel="icon" href="./../../assets/img/brute-force.png" />
  <title>Brute-Force Passwords</title>
</head>
<body>
<!-- Navigation Menu-->
<nav class="hide-on-small-only">
  <ul class="side-nav fixed section table-of-contents">
    <li class="logo">
      <a id="logo-container" aria-label="Navigate to the beginning of the page" href="#intro"
      class="brand-logo grey-blue-text">
      <img src="./../../assets/img/brute-force.png" class="img-responsive nav-pic" alt="avatar">
      </a>
    </li>
    <li class="bold">
      <a aria-label="Back to the Theory section" href="./index.html#vulnerable-websites" class="waves-effect waves-dark teal-text"><i
      class="mdi mdi-arrow-collapse-left small"></i><span>Go Back</span></a>
    </li>
    <li class="bold">
      <a aria-label="Scenario" href="#scenario" class="waves-effect waves-dark teal-text"><i
      class="mdi mdi-account-question small"></i><span>Scenario</span></a>
    </li>
    <li class="bold">
      <a aria-label="Easy Crack" href="#first-level" class="waves-effect waves-dark teal-text"><i
      class="mdi mdi-dice-1 small"></i><span>Easy Crack</span></a>
    </li>
    <li class="bold">
      <a aria-label="Intermediate Crack" href="#second-level" class="waves-effect waves-dark teal-text"><i
      class="mdi mdi-dice-3 small"></i><span>Medium Crack</span></a>
    </li>
    <li class="bold">
      <a aria-label="Hard Crack" href="#third-level" class="waves-effect waves-dark teal-text"><i
      class="mdi mdi-dice-6 small"></i><span>Hard Crack</span></a>
    </li>
  </ul>
</nav>

<!-- Main Content-->
<main>

<!-- First Section: Scenario -->
<section id="scenario" class="section scrollspy">
  <h3 class="page-title white-text teal">Scenario</h3>
  <div class="container flow-text">     
    <p>
      <b>Scenario:</b><br>
      During a pentesting assignment for Gda≈Ñsk University of Technology, you managed to gain access to an unsecured resource that had the .db extension. 
      Using your impeccable deduction skills, you loaded this file into any database interpreter and found many combinations of usernames and hashed passwords. 
      As it was a collective backup of data from many systems, different records were secured in different ways. Your task is to use available tools and obtain clear text passwords.
    </p>
    <p>
      Tools that will be useful when carrying out this task:<br>
      - <a href="https://crackstation.net/" target="_blank">Crackstation</a><br>
      - <a href="https://medium.com/@m5kro/hashcat-vs-john-the-ripper-jtr-f207c34c5b1c" target="_blank">JohnTheRipper and Hashcat</a><br>
      - <a href="https://hashcat.net/wiki/doku.php?id=example_hashes" target="_blank">Hashcat - example hashes</a>
      - <a href="https://github.com/praetorian-inc/Hob0Rules/blob/master/wordlists/rockyou.txt.gz" target="_blank">Rockyou password list</a><br>
      - <a href="https://noraj.github.io/haiti/" target="_blank">Haiti tool to recognize hashes</a>
    </p>
    <p>
      If you need any help, you can check the comments left by developers around a given section's source code.
    </p>
  </div>
</section>

<!-- Second Section: First Level of Difficulty -->
<section id="first-level" class="section scrollspy">
  <h3 class="page-title white-text teal">Easy to crack</h3>
  <div class="container flow-text">     
    <p>
      The most eye-catching passwords are the easiest to crack. To warm up, try cracking the following four passwords and see if you get it right.
    </p>
    <p>
      Record number one from the easy hash list: <br><b>CBFDAC6008F9CAB4083784CBD1874F76618D2A97</b> 
      <!-- Hint: Bro... use the online tools -->
      <input type="text" id="easy1" class="input-module1">
      <br><br>
      <button id="easy1-button" onclick="checkPassword('easy1')" class="button-module1">It was so easy?</button>
    </p>
    <p>
      Record number two from the easy hash list: <br><b>1C8BFE8F801D79745C4631D09FFF36C82AA37FC4CCE4FC946683D7B336B63032</b> 
      <!-- Hint: Bro... use the online tools -->
      <input type="text" id="easy2" class="input-module1">
      <br><br>
      <button id="easy2-button" onclick="checkPassword('easy2')" class="button-module1">Give me something harder</button>
    </p>
    <p>
      Record number three from the easy hash list: <br><b>$2y$12$Dwt1BZj6pcyc3Dy1FWZ5ieeUznr71EeNkJkUlypTsgbX1H68wsRom</b> 
      <!-- Hint: Bro... use the online tools -->
      <input type="text" id="easy3" class="input-module1">
      <br><br>
      <button id="easy3-button" onclick="checkPassword('easy3')" class="button-module1">blah</button>
    </p>
    <p>
      Record number four from the easy hash list: <br><b>279412f945939ba78ce0758d3fd83daa</b> 
      <!-- Hint: Bro... use the online tools -->
      <input type="text" id="easy4" class="input-module1">
      <br><br>
      <button id="easy4-button" onclick="checkPassword('easy4')" class="button-module1">For eternity!</button>
    </p>
  </div>
</section>

<!-- Third Section: Second Level of Difficulty -->
<section id="second-level" class="section scrollspy">
  <h3 class="page-title white-text teal">Intermediate to crack</h3>
  <div class="container flow-text">     
    <p>
      In some cases, we need to use installed tools to break the given hash. This is the case with intermediate hashing algorithms.
    </p>
    <p>
      Record number one from the intermediate hash list: <br><b>F09EDCB1FCEFC6DFB23DC3505A882655FF77375ED8AA2D1C13F640FCCC2D0C85</b> 
      <!-- Hint: SHA256... you can still use online tools for this one -->
      <input type="text" id="intermediate1" class="input-module1">
      <br><br>
      <button id="intermediate1-button" onclick="checkPassword('intermediate1')" class="button-module1">Coelho</button>
    </p>
    <p>
      Record number two from the intermediate hash list: <br><b>1DFECA0C002AE40B8619ECF94819CC1B</b> 
      <!-- Hint: This is NTLM hash, popularly used in Windows systems... pentesters love them! -->
      <input type="text" id="intermediate2" class="input-module1">
      <br><br>
      <button id="intermediate2-button" onclick="checkPassword('intermediate2')" class="button-module1">I don't even know</button>
    </p>
    <p>
      What kind of hash is this? <br><b>741ebf5166b9ece4cca88a3868c44871e8370707cf19af3ceaa4a6fba006f224ae03f39153492853</b> 
      <!-- Hint: Launch Haiti!!! -->
      <input type="text" id="intermediate3" class="input-module1">
      <br><br>
      <button id="intermediate3-button" onclick="checkPassword('intermediate3')" class="button-module1">rest in peace</button>
    </p>
    <p>
      What is Keccak-256 Hashcat code?<br>
      <!-- Hint: Use page provided by hashcat developers or run the man hashcat command -->
      <input type="text" id="intermediate4" class="input-module1">
      <br><br>
      <button id="intermediate4-button" onclick="checkPassword('intermediate4')" class="button-module1">more than 420</button>
    </p>
  </div>
</section>

<!-- Fourth Section: Third Level of Difficulty -->
<section id="third-level" class="section scrollspy">
  <h3 class="page-title white-text teal">Hard to crack</h3>
  <div class="container flow-text">     
    <p>
      At the very end of the database to which we gained access, we noticed the records we were interested in, signed as "Administrator" and "root". 
      Can you crack their passwords using salt that was provided in database comment?
    </p>
    <p>
      Hash of Administrator user: <br><b>$6$aReallyHardSalt$6WKUTqzq.UQQmrm0p/T7MPpMbGNnzXPMAXi4bJMl9be.cfi3/qxIf.hsGpS41BqMhSrHVXgMpdjS6xeKZAs02.</b><br>
      Salt from the database comment: <br><b>aReallyHardSalt</b>
      <!-- Hint: Be really patient with SHA512-crypt my man -->
      <input type="text" id="hard1" class="input-module1">
      <br><br>
      <button id="hard1-button" onclick="checkPassword('hard1')" class="button-module1">it has to work</button>
    </p>
    <p>
      Hash of root user: <br><b>e5d8870e5bdd26602cab8dbe07a942c8669e56d6</b><br>
      Salt from the database comment: <br><b>tryhackme</b>
      <!-- Hint: HMAC-SHA1 -->
      <input type="text" id="hard2" class="input-module1">
      <br><br>
      <button id="hard2-button" onclick="checkPassword('hard2');" class="button-module1">root?</button>
    </p>
  </div>
  <br><br><br><br><br><br><br><br><br><br><br><br><br><br>
</section>

</main>

<!-- jQuery-->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>

<!-- Materialize - Compiled and minified JavaScript-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.95.3/js/materialize.min.js"></script>
<script>
  // Materialize - Initializers
  $(document).ready(function () {
  $(".scrollspy").scrollSpy()
  // Initialize collapse button
  $(".button-collapse").sideNav({
    menuWidth: 190, // Default is 240
    edge: "left", // Choose the horizontal origin
    closeOnClick: true // Closes side-nav on <a> clicks, useful for Angular/Meteor
  })
  });

  const passwordConstants = {
    easy1: "password123",
    easy2: "letmein",
    easy3: "bleh",
    easy4: "Eternity22",
    intermediate1: "paule",
    intermediate2: "n63umy8lkf4i",
    intermediate3: "RIPEMD-320",
    intermediate4: "17800",
    hard1: "waka99",
    hard2: "481616481616",
  };

  function checkPassword(passwordID) {
    const inputField = document.getElementById(passwordID);
    const button = document.getElementById(passwordID + "-button");

    if (inputField && passwordConstants[passwordID] === inputField.value) {
      inputField.style.background = "lightgreen";
      button.style.background = "green";
    } else {
      inputField.style.background = "lightcoral";
      button.style.background = "red";
    }
  }
</script>

</body>
</html>